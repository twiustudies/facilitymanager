{% extends "base.html" %}
{% block content %}
<h1>WartungsplÃ¤ne</h1>

<!-- Suchfeld fÃ¼r Live-Suche -->
<input type="text" id="searchInput" placeholder="Suche nach GebÃ¤ude, Wartungstyp oder Datum..." onkeyup="searchMaintenance()">

<!-- Export-Buttons fÃ¼r CSV und PDF -->
<a href="{{ url_for('maintenance.export_csv') }}" class="btn">ðŸ“„ Export als CSV</a>
<a href="{{ url_for('maintenance.export_pdf') }}" class="btn">ðŸ“œ Export als PDF</a>

<!-- Link zum Erstellen eines neuen Wartungsplans -->
<a href="{{ url_for('maintenance.add_maintenance') }}">Neuen Wartungsplan erstellen</a>

<!-- Wartungsliste -->
<ul id="maintenanceList">
  {% for plan in maintenance_plans %}
  <li class="maintenance-item">
    <span class="maintenance-data">
      GebÃ¤ude-ID: {{ plan.building_id }}, Datum: {{ plan.date }}, Auftrag: {{ plan.description }}
    </span>
    <a href="{{ url_for('maintenance.edit_maintenance', plan_id=plan.id) }}">Bearbeiten</a>
    <form action="{{ url_for('maintenance.delete_maintenance', plan_id=plan.id) }}" method="post" style="display:inline;">
      <button type="submit">LÃ¶schen</button>
    </form>
  </li>
  {% endfor %}
</ul>

<!-- Nachricht, wenn keine Ergebnisse gefunden wurden -->
<p id="noResultsMessage" style="display: none;">Keine WartungseintrÃ¤ge gefunden.</p>

<script>
function searchMaintenance() {
    let input = document.getElementById("searchInput").value.toLowerCase();
    let items = document.querySelectorAll(".maintenance-item");
    let found = false;

    items.forEach(item => {
        let text = item.querySelector(".maintenance-data").textContent.toLowerCase();
        if (text.includes(input)) {
            item.style.display = "block";
            found = true;
        } else {
            item.style.display = "none";
        }
    });

    document.getElementById("noResultsMessage").style.display = found ? "none" : "block";
}
</script>

<style>
  #searchInput {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    font-size: 16px;
  }

  .maintenance-item {
    margin: 10px 0;
    padding: 10px;
    border-bottom: 1px solid #ccc;
  }
</style>

{% endblock %}
